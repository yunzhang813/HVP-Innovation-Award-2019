<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bulk RNA-seq Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HVP-Innovation-Award-2019</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="data.html">Data Prep</a>
</li>
<li>
  <a href="bulk.html">Bulk RNA-seq Analysis</a>
</li>
<li>
  <a href="deconv.html">Deconvolution Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bulk RNA-seq Analysis</h1>

</div>


<p><br></p>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The <strong>goal</strong> of this analysis is to identify differentially expressed genes (DEG) between responders and non-responders in the HVP01 study using the bulk RNA-seq data.</p>
<p>From whole blood transcriptome profiling, we have bulk RNA-seq data for 15 subjects over 5 time points (visit day 0,1,3,7,14). The studied Hepatitis B Vaccine (drug: ENGERIX®-B) consists of three doses. After each dose, response to the vaccination is determined by the anti-HBs antibody level above 10 mIU/mL.</p>
<p>In this report, we focus on the <strong>response after dose 2</strong> (with 13 responders and two non-responders). At a single time point, we perform a naive t-test. To include multiple time points, we also perform the parametric <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-2783-8">PBtest</a>, which takes into account the repeated measurement data structure.</p>
<p>This report is organized in the following sections.</p>
<ul>
<li><a href="#ctab">Sample table</a>: vaccine response and other meta data for each sample.</li>
<li><a href="#ttest">Single time point analysis</a>: t-test for response after dose 2 with Day 7 data only.</li>
<li><a href="#PBtest">Multiple time points analysis</a>: parametric PBtest for response after dose 2 with all time points.</li>
</ul>
<p>Load useful packages.</p>
<pre class="r"><code>library(genefilter)
library(PBtest)</code></pre>
<p>In the following analyses, significance level is set at 5%. Benjamini-Hochberg multiple testing correction will be applied.</p>
<pre class="r"><code>alpha &lt;- 0.05</code></pre>
<p><br></p>
</div>
<div id="ctab" class="section level2">
<h2>Sample table</h2>
<p>Earlier, we read in “HVP_sampleTable_response_May18.csv” to <code>ctab</code>, which contains the dose response and other clinical information for each sample in the expression matrix.</p>
<pre class="r"><code>kable(ctab) %&gt;%
  kable_styling(bootstrap_options = c(&quot;hover&quot;)) %&gt;%
  scroll_box(width = &quot;100%&quot;, height = &quot;300px&quot;)</code></pre>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Sample_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Subject_id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Visit_day
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Responder_dose1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Responder_dose2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Age
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Age_Group
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GR01_V3
</td>
<td style="text-align:left;">
GR01
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR01_V4
</td>
<td style="text-align:left;">
GR01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR01_V5
</td>
<td style="text-align:left;">
GR01
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR01_V6
</td>
<td style="text-align:left;">
GR01
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR01_V7
</td>
<td style="text-align:left;">
GR01
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR02_V3
</td>
<td style="text-align:left;">
GR02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR02_V4
</td>
<td style="text-align:left;">
GR02
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR02_V5
</td>
<td style="text-align:left;">
GR02
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR02_V6
</td>
<td style="text-align:left;">
GR02
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR02_V7
</td>
<td style="text-align:left;">
GR02
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR03_V3
</td>
<td style="text-align:left;">
GR03
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR03_V4
</td>
<td style="text-align:left;">
GR03
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR03_V5
</td>
<td style="text-align:left;">
GR03
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR03_V6
</td>
<td style="text-align:left;">
GR03
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR03_V7
</td>
<td style="text-align:left;">
GR03
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR04_V3
</td>
<td style="text-align:left;">
GR04
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR04_V4
</td>
<td style="text-align:left;">
GR04
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR04_V5
</td>
<td style="text-align:left;">
GR04
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR04_V6
</td>
<td style="text-align:left;">
GR04
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR04_V7
</td>
<td style="text-align:left;">
GR04
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR05_V3
</td>
<td style="text-align:left;">
GR05
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR05_V4
</td>
<td style="text-align:left;">
GR05
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR05_V5
</td>
<td style="text-align:left;">
GR05
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR05_V6
</td>
<td style="text-align:left;">
GR05
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR05_V7
</td>
<td style="text-align:left;">
GR05
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR06_V3
</td>
<td style="text-align:left;">
GR06
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR06_V4
</td>
<td style="text-align:left;">
GR06
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR06_V5
</td>
<td style="text-align:left;">
GR06
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR06_V6
</td>
<td style="text-align:left;">
GR06
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR06_V7
</td>
<td style="text-align:left;">
GR06
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR07_V3
</td>
<td style="text-align:left;">
GR07
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR07_V4
</td>
<td style="text-align:left;">
GR07
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR07_V5
</td>
<td style="text-align:left;">
GR07
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR07_V6
</td>
<td style="text-align:left;">
GR07
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR07_V7
</td>
<td style="text-align:left;">
GR07
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR09_V3
</td>
<td style="text-align:left;">
GR09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR09_V4
</td>
<td style="text-align:left;">
GR09
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR09_V5
</td>
<td style="text-align:left;">
GR09
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR09_V6
</td>
<td style="text-align:left;">
GR09
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR09_V7
</td>
<td style="text-align:left;">
GR09
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR10_V3
</td>
<td style="text-align:left;">
GR10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR10_V4
</td>
<td style="text-align:left;">
GR10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR10_V5
</td>
<td style="text-align:left;">
GR10
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR10_V6
</td>
<td style="text-align:left;">
GR10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR10_V7
</td>
<td style="text-align:left;">
GR10
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR11_V3
</td>
<td style="text-align:left;">
GR11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR11_V4
</td>
<td style="text-align:left;">
GR11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR11_V5
</td>
<td style="text-align:left;">
GR11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR11_V6
</td>
<td style="text-align:left;">
GR11
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR11_V7
</td>
<td style="text-align:left;">
GR11
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR13_V3
</td>
<td style="text-align:left;">
GR13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR13_V4
</td>
<td style="text-align:left;">
GR13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR13_V5
</td>
<td style="text-align:left;">
GR13
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR13_V6
</td>
<td style="text-align:left;">
GR13
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR13_V7
</td>
<td style="text-align:left;">
GR13
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR15_V3
</td>
<td style="text-align:left;">
GR15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR15_V4
</td>
<td style="text-align:left;">
GR15
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR15_V5
</td>
<td style="text-align:left;">
GR15
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR15_V6
</td>
<td style="text-align:left;">
GR15
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR15_V7
</td>
<td style="text-align:left;">
GR15
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
young
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR17_V3
</td>
<td style="text-align:left;">
GR17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR17_V4
</td>
<td style="text-align:left;">
GR17
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR17_V5
</td>
<td style="text-align:left;">
GR17
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR17_V6
</td>
<td style="text-align:left;">
GR17
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR17_V7
</td>
<td style="text-align:left;">
GR17
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
F
</td>
</tr>
<tr>
<td style="text-align:left;">
GR18_V3
</td>
<td style="text-align:left;">
GR18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR18_V4
</td>
<td style="text-align:left;">
GR18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR18_V5
</td>
<td style="text-align:left;">
GR18
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR18_V6
</td>
<td style="text-align:left;">
GR18
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR18_V7
</td>
<td style="text-align:left;">
GR18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR19_V3
</td>
<td style="text-align:left;">
GR19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR19_V4
</td>
<td style="text-align:left;">
GR19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR19_V5
</td>
<td style="text-align:left;">
GR19
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR19_V6
</td>
<td style="text-align:left;">
GR19
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
<tr>
<td style="text-align:left;">
GR19_V7
</td>
<td style="text-align:left;">
GR19
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
old
</td>
<td style="text-align:left;">
M
</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
</div>
<div id="ttest" class="section level2">
<h2>Single time point analysis</h2>
<p>In vaccine studies, it is common to look at the Day 7 post-vacctine data given the time lag between vaccination and immune activation. At the single time point, we can simply use the t-test to compare between the responders and non-responders.</p>
<div id="t-test-for-response-after-dose-2-with-day-7-data" class="section level4">
<h4>T-test for response after dose 2 with Day 7 data</h4>
<pre class="r"><code>## subset Day 7 column data
ctab.D7 &lt;- ctab %&gt;% filter(Visit_day==7)

## t-test
out.t.D7 &lt;- rowttests(dat.filt10.symbol[,ctab.D7$Sample_name], as.factor(ctab.D7$Responder_dose2))
padj.t.D7 &lt;- p.adjust(out.t.D7$p.value, method=&quot;BH&quot;)
names(padj.t.D7) &lt;- rownames(out.t.D7)
(sig.gene.D7 &lt;- names(which(padj.t.D7&lt;alpha))) #1 DEG</code></pre>
<pre><code>## [1] &quot;WSB2&quot;</code></pre>
<pre class="r"><code>head(sort(padj.t.D7)) #top genes</code></pre>
<pre><code>##       WSB2    TMEM201      MYBL2      SYT17     ZNF142       AAK1 
## 0.03943521 0.07863648 0.42500969 0.56207867 0.56207867 0.56207867</code></pre>
<p>There is only 1 DEG identified using sinlge time point at Day 7. The following plot shows that this gene is under-regulated in the responders.</p>
<pre class="r"><code>## plot
plot(dat.filt10.symbol[sig.gene.D7,ctab.D7$Sample_name], 
     col=as.factor(ctab.D7$Responder_dose2), pch=19,
     xlab=&quot;Subject&quot;, ylab=&quot;Day 7 expression level&quot;, 
     main=paste0(sig.gene.D7, &quot;, p-value = &quot;, round(padj.t.D7[sig.gene.D7],3)))
legend(&quot;topleft&quot;, c(&quot;Non-responder&quot;,&quot;Responder&quot;), col=1:2, pch=19)</code></pre>
<p><img src="bulk_files/figure-html/ttest-plot-1.png" width="50%" /></p>
<p><br></p>
</div>
</div>
<div id="PBtest" class="section level2">
<h2>Multiple time points analysis</h2>
<p>Immune response is a dynamic procedure. Using just one time point limits the scope of our analysis. With PBtest, a highly efficient hypothesis testing method for regression-type tests with correlated observations and heterogeneous variance structure, we are able to include all time points available in the study. It reveals more DEGs between the responders and non-responders.</p>
<div id="pbtest-for-response-after-does-2-with-all-time-points" class="section level4">
<h4>PBtest for response after does 2 with all time points</h4>
<pre class="r"><code>## PBtest
out.PBtest &lt;- PBtest(YY=t(dat.filt10.symbol), 
                     xx=as.factor(ctab$Responder_dose2), 
                     id=ctab$Subject_id)
padj.PBtest &lt;- p.adjust(out.PBtest$p.value, method=&quot;BH&quot;)
names(padj.PBtest) &lt;- names(out.PBtest$p.value)
padj.PBtest.sorted &lt;- sort(padj.PBtest)
(sig.gene.PBtest &lt;- names(padj.PBtest.sorted)[padj.PBtest.sorted&lt;alpha]) #14 DEGs</code></pre>
<pre><code>##  [1] &quot;CYP4F29P&quot;    &quot;ANKRD20A11P&quot; &quot;TAGLN&quot;       &quot;ZNF774&quot;      &quot;IGLV3-21&quot;   
##  [6] &quot;NBPF26&quot;      &quot;IGHV4-4&quot;     &quot;CD8A&quot;        &quot;TCL1A&quot;       &quot;MYBL2&quot;      
## [11] &quot;CD8B&quot;        &quot;MMP17&quot;       &quot;CORO2B&quot;      &quot;IGHV4-39&quot;</code></pre>
<pre class="r"><code>padj.PBtest.sorted[1:30] #top genes</code></pre>
<pre><code>##      CYP4F29P   ANKRD20A11P         TAGLN        ZNF774      IGLV3-21 
##   0.001209757   0.001523306   0.009972987   0.009972987   0.009972987 
##        NBPF26       IGHV4-4          CD8A         TCL1A         MYBL2 
##   0.009972987   0.009972987   0.025889548   0.027076586   0.027315378 
##          CD8B         MMP17        CORO2B      IGHV4-39        LARGE1 
##   0.027315378   0.027315378   0.037506093   0.047982663   0.058518654 
##          IGHD        THEMIS           JUP      IGHV3-21  CTD-3064M3.3 
##   0.058518654   0.061576042   0.061576042   0.061576042   0.061576042 
##       HLA-DMB         SHTN1       IGHV1-3 RP11-164H13.1        CDKN1C 
##   0.063839415   0.065953526   0.087418335   0.087638782   0.096983455 
##      IGLV6-57         HDHD3          CPVL         EOMES          TCL6 
##   0.107899649   0.114981091   0.122971924   0.124335118   0.124335118</code></pre>
<p>Using all time points, 14 DEGs are identified using PBtest. The following plots show the expression levels of those DEGs across time in responders and non-responders.</p>
<pre class="r"><code>## plot
for(gene in sig.gene.PBtest){
  x &lt;- dat.filt10.symbol[gene,]
  df.x &lt;- ctab %&gt;% mutate(Expression=x)
  g &lt;- ggplot(data=df.x, aes(x=Visit_day, y=Expression, group=Subject_id, colour=Responder_dose2)) +
    geom_line(aes(linetype=Responder_dose2)) + geom_point() +
    scale_linetype_manual(values=c(&quot;dashed&quot;, &quot;solid&quot;)) +
    ggtitle(paste0(gene, &quot;, p-value = &quot;, round(padj.PBtest[gene],3)))
  plot(g)
}</code></pre>
<p><img src="bulk_files/figure-html/PBtest-plot-1.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-2.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-3.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-4.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-5.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-6.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-7.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-8.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-9.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-10.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-11.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-12.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-13.png" width="50%" /><img src="bulk_files/figure-html/PBtest-plot-14.png" width="50%" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
